<!DOCTYPE html>
<html>
<head>
  <title>Mapa com Marcadores</title>
  <style>
    #map {
      height: 400px;
      width: 100%;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />

  <script>
    // Array de localizações
    var locations = [
      {
        name: 'Localização 1',
        lat: -23.550520,
        lng: -46.633308,
        info: 'Informações sobre a Localização 1'
      },
      {
        name: 'Localização 2',
        lat: -23.550520,
        lng: -46.633308,
        info: 'Informações sobre a Localização 2'
      },
      {
        name: 'Localização 2',
        lat: -23.564830,
        lng: -46.652770,
        info: 'Informações sobre a Localização 2'
      },
      {
        name: 'Localização 3',
        lat: -23.581250,
        lng: -46.657780,
        info: 'Informações sobre a Localização 3'
      }
      // Adicione mais localizações conforme necessário
    ];

    var map = L.map('map').setView([-23.550520, -46.633308], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    var markers = []; // Array para armazenar os marcadores

    // Ícones personalizados
    var redIcon = L.icon({
      iconUrl: 'pin-vermelho.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34]
    });

    var blueIcon = L.icon({
      iconUrl: 'pin-azul.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34]
    });

    // Adiciona marcadores ao mapa
    locations.forEach(function(location) {
      var marker = L.marker([location.lat, location.lng], { icon: redIcon }).addTo(map);

      // Informações exibidas ao passar o mouse sobre o marcador
      marker.bindPopup(location.info);

      // Verifica se há sobreposição com outro marcador
      var overlappingMarker = markers.find(function(existingMarker) {
        return existingMarker.getLatLng().equals(marker.getLatLng());
      });

      if (overlappingMarker) {
        // Se houver sobreposição, adicione um aviso
        marker.bindTooltip('Sobreposição de localização').openTooltip();
      }

      // Armazena o marcador no array
      markers.push(marker);

      // Exibir menu de opções ao clicar com o botão direito do mouse
      marker.on('contextmenu', function(e) {
        e.originalEvent.preventDefault(); // Impede o menu de contexto padrão

        var options = [
          {
            label: 'Remover',
            action: function() {
              map.removeLayer(marker);
            }
          },
          {
            label: 'Detalhes',
            action: function() {
              alert(location.info);
            }
          }
        ];

        var menu = L.popup()
          .setLatLng(e.latlng)
          .setContent(generateMenuHtml(options))
          .openOn(map);

        // Captura o evento de clique em cada opção do menu
        options.forEach(function(option, index) {
          var element = document.getElementById('menu-option-' + index);
          element.addEventListener('click', function() {
            option.action();
            map.closePopup(menu);
          });
        });
      });
    });

    // Função auxiliar para gerar o HTML do menu de opções
    function generateMenuHtml(options) {
      var html = '<ul>';
      options.forEach(function(option, index) {
        html += '<li><a id="menu-option-' + index + '" href="#">' + option.label + '</a></li>';
      });
      html += '</ul>';
      return html;
    }
  </script>
</body>
</html>
